====================== Initialization ======================
rank :          0
local_rank :    0
world_size :    2
local_size :    2
master :        127.0.0.1:12350
device :        0
cpus :          [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1
                3, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]

====================== Initialization ======================
rank :          1
local_rank :    1
world_size :    2
local_size :    2
master :        127.0.0.1:12350
device :        1
cpus :          [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
                 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45,
                 46, 47]

total training instance number: 200
total training iterations: 251
warm-up iterations: 50
loading tokenizer...
load from local file: ../checkpoints/Llama-2-7b-mc
finished
loading model...
load from local file: ../checkpoints/Llama-2-7b-mc
load from local file: ../checkpoints/Llama-2-7b-mc
encoder.layers.0.weight_bias
encoder.layers.0.lora_fusion_gate.weight
encoder.layers.1.weight_bias
encoder.layers.1.lora_fusion_gate.weight
encoder.layers.2.weight_bias
encoder.layers.2.lora_fusion_gate.weight
encoder.layers.3.weight_bias
encoder.layers.3.lora_fusion_gate.weight
encoder.layers.4.weight_bias
encoder.layers.4.lora_fusion_gate.weight
encoder.layers.5.weight_bias
encoder.layers.5.lora_fusion_gate.weight
encoder.layers.6.weight_bias
encoder.layers.6.lora_fusion_gate.weight
encoder.layers.7.weight_bias
encoder.layers.7.lora_fusion_gate.weight
encoder.layers.8.weight_bias
encoder.layers.8.lora_fusion_gate.weight
encoder.layers.9.weight_bias
encoder.layers.9.lora_fusion_gate.weight
encoder.layers.10.weight_bias
encoder.layers.10.lora_fusion_gate.weight
encoder.layers.11.weight_bias
encoder.layers.11.lora_fusion_gate.weight
encoder.layers.12.weight_bias
encoder.layers.12.lora_fusion_gate.weight
encoder.layers.13.weight_bias
encoder.layers.13.lora_fusion_gate.weight
encoder.layers.14.weight_bias
encoder.layers.14.lora_fusion_gate.weight
encoder.layers.15.weight_bias
encoder.layers.15.lora_fusion_gate.weight
encoder.layers.16.weight_bias
encoder.layers.16.lora_fusion_gate.weight
encoder.layers.17.weight_bias
encoder.layers.17.lora_fusion_gate.weight
encoder.layers.18.weight_bias
encoder.layers.18.lora_fusion_gate.weight
encoder.layers.19.weight_bias
encoder.layers.19.lora_fusion_gate.weight
encoder.layers.20.weight_bias
encoder.layers.20.lora_fusion_gate.weight
encoder.layers.21.weight_bias
encoder.layers.21.lora_fusion_gate.weight
encoder.layers.22.weight_bias
encoder.layers.22.lora_fusion_gate.weight
encoder.layers.23.weight_bias
encoder.layers.23.lora_fusion_gate.weight
encoder.layers.24.weight_bias
encoder.layers.24.lora_fusion_gate.weight
encoder.layers.25.weight_bias
encoder.layers.25.lora_fusion_gate.weight
encoder.layers.26.weight_bias
encoder.layers.26.lora_fusion_gate.weight
encoder.layers.27.weight_bias
encoder.layers.27.lora_fusion_gate.weight
encoder.layers.28.weight_bias
encoder.layers.28.lora_fusion_gate.weight
encoder.layers.29.weight_bias
encoder.layers.29.lora_fusion_gate.weight
encoder.layers.30.weight_bias
encoder.layers.30.lora_fusion_gate.weight
encoder.layers.31.weight_bias
encoder.layers.31.lora_fusion_gate.weight
finished
encoder.layers.0.weight_bias
encoder.layers.0.lora_fusion_gate.weight
encoder.layers.1.weight_bias
encoder.layers.1.lora_fusion_gate.weight
encoder.layers.2.weight_bias
encoder.layers.2.lora_fusion_gate.weight
encoder.layers.3.weight_bias
encoder.layers.3.lora_fusion_gate.weight
encoder.layers.4.weight_bias
encoder.layers.4.lora_fusion_gate.weight
encoder.layers.5.weight_bias
encoder.layers.5.lora_fusion_gate.weight
encoder.layers.6.weight_bias
encoder.layers.6.lora_fusion_gate.weight
encoder.layers.7.weight_bias
encoder.layers.7.lora_fusion_gate.weight
encoder.layers.8.weight_bias
encoder.layers.8.lora_fusion_gate.weight
encoder.layers.9.weight_bias
encoder.layers.9.lora_fusion_gate.weight
encoder.layers.10.weight_bias
encoder.layers.10.lora_fusion_gate.weight
encoder.layers.11.weight_bias
encoder.layers.11.lora_fusion_gate.weight
encoder.layers.12.weight_bias
encoder.layers.12.lora_fusion_gate.weight
encoder.layers.13.weight_bias
encoder.layers.13.lora_fusion_gate.weight
encoder.layers.14.weight_bias
encoder.layers.14.lora_fusion_gate.weight
encoder.layers.15.weight_bias
encoder.layers.15.lora_fusion_gate.weight
encoder.layers.16.weight_bias
encoder.layers.16.lora_fusion_gate.weight
encoder.layers.17.weight_bias
encoder.layers.17.lora_fusion_gate.weight
encoder.layers.18.weight_bias
encoder.layers.18.lora_fusion_gate.weight
encoder.layers.19.weight_bias
encoder.layers.19.lora_fusion_gate.weight
encoder.layers.20.weight_bias
encoder.layers.20.lora_fusion_gate.weight
encoder.layers.21.weight_bias
encoder.layers.21.lora_fusion_gate.weight
encoder.layers.22.weight_bias
encoder.layers.22.lora_fusion_gate.weight
encoder.layers.23.weight_bias
encoder.layers.23.lora_fusion_gate.weight
encoder.layers.24.weight_bias
encoder.layers.24.lora_fusion_gate.weight
encoder.layers.25.weight_bias
encoder.layers.25.lora_fusion_gate.weight
encoder.layers.26.weight_bias
encoder.layers.26.lora_fusion_gate.weight
encoder.layers.27.weight_bias
encoder.layers.27.lora_fusion_gate.weight
encoder.layers.28.weight_bias
encoder.layers.28.lora_fusion_gate.weight
encoder.layers.29.weight_bias
encoder.layers.29.lora_fusion_gate.weight
encoder.layers.30.weight_bias
encoder.layers.30.lora_fusion_gate.weight
encoder.layers.31.weight_bias
encoder.layers.31.lora_fusion_gate.weight
use cosine
Model memory
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    6780 MB |    7280 MB |   72592 MB |   65812 MB |
|       from large pool |    6780 MB |    7280 MB |   71324 MB |   64544 MB |
|       from small pool |       0 MB |      10 MB |    1268 MB |    1268 MB |
|---------------------------------------------------------------------------|
| Active memory         |    6780 MB |    7280 MB |   72592 MB |   65812 MB |
|       from large pool |    6780 MB |    7280 MB |   71324 MB |   64544 MB |
|       from small pool |       0 MB |      10 MB |    1268 MB |    1268 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    7694 MB |    7694 MB |    7694 MB |       0 B  |
|       from large pool |    7680 MB |    7680 MB |    7680 MB |       0 B  |
|       from small pool |      14 MB |      14 MB |      14 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2043 KB |   22415 KB |    8609 MB |    8607 MB |
|       from large pool |       0 KB |   15008 KB |    7164 MB |    7164 MB |
|       from small pool |    2043 KB |    7407 KB |    1445 MB |    1443 MB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |      75    |    5612    |    5575    |
|       from large pool |      34    |      41    |    1704    |    1670    |
|       from small pool |       3    |      35    |    3908    |    3905    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |      75    |    5612    |    5575    |
|       from large pool |      34    |      41    |    1704    |    1670    |
|       from small pool |       3    |      35    |    3908    |    3905    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      53    |       0    |
|       from large pool |      46    |      46    |      46    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       8    |     877    |     876    |
|       from large pool |       0    |       1    |     512    |     512    |
|       from small pool |       1    |       8    |     365    |     364    |
|---------------------------------------------------------------------------|
| Oversize allocations  |      32    |      34    |      38    |       6    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |      34    |      34    |      34    |       0    |
|===========================================================================|

Gradient overflow, change scale from 6553600.000000 to 3276800.000000
| Epoch:   0 | Iter:      1 | loss: 0.8636 average_loss: 0.8636 | lr: 0.0000e+00 | time: 11.5053 seconds | total_time_passed: 0.1919 minutes
Gradient overflow, change scale from 3276800.000000 to 1638400.000000
| Epoch:   0 | Iter:      2 | loss: 0.6766 average_loss: 0.7652 | lr: 0.0000e+00 | time: 9.7259 seconds | total_time_passed: 0.3273 minutes
Gradient overflow, change scale from 1638400.000000 to 819200.000000
| Epoch:   0 | Iter:      3 | loss: 0.6269 average_loss: 0.7142 | lr: 0.0000e+00 | time: 9.0739 seconds | total_time_passed: 0.4601 minutes
Gradient overflow, change scale from 819200.000000 to 409600.000000
| Epoch:   0 | Iter:      4 | loss: 0.7237 average_loss: 0.7169 | lr: 0.0000e+00 | time: 8.7490 seconds | total_time_passed: 0.5927 minutes
Gradient overflow, change scale from 409600.000000 to 204800.000000
| Epoch:   0 | Iter:      5 | loss: 0.5955 average_loss: 0.6873 | lr: 0.0000e+00 | time: 8.5559 seconds | total_time_passed: 0.7254 minutes
Gradient overflow, change scale from 204800.000000 to 102400.000000
| Epoch:   0 | Iter:      6 | loss: 0.8565 average_loss: 0.7234 | lr: 0.0000e+00 | time: 8.4284 seconds | total_time_passed: 0.8582 minutes
Gradient overflow, change scale from 102400.000000 to 51200.000000
| Epoch:   0 | Iter:      7 | loss: 0.8347 average_loss: 0.7447 | lr: 0.0000e+00 | time: 8.3381 seconds | total_time_passed: 0.9908 minutes
Gradient overflow, change scale from 51200.000000 to 25600.000000
| Epoch:   0 | Iter:      8 | loss: 0.7416 average_loss: 0.7442 | lr: 0.0000e+00 | time: 8.2712 seconds | total_time_passed: 1.1235 minutes
| Epoch:   0 | Iter:      9 | loss: 0.6641 average_loss: 0.7311 | lr: 2.0000e-05 | time: 8.2304 seconds | total_time_passed: 1.2573 minutes
| Epoch:   0 | Iter:     10 | loss: 0.7068 average_loss: 0.7274 | lr: 4.0000e-05 | time: 8.1982 seconds | total_time_passed: 1.3911 minutes
| Epoch:   0 | Iter:     11 | loss: 0.7996 average_loss: 0.7379 | lr: 6.0000e-05 | time: 8.1713 seconds | total_time_passed: 1.5247 minutes
| Epoch:   0 | Iter:     12 | loss: 0.7602 average_loss: 0.7410 | lr: 8.0000e-05 | time: 8.1505 seconds | total_time_passed: 1.6586 minutes
| Epoch:   0 | Iter:     13 | loss: 0.4967 average_loss: 0.7083 | lr: 1.0000e-04 | time: 8.1332 seconds | total_time_passed: 1.7924 minutes
Gradient overflow, change scale from 25600.000000 to 12800.000000
| Epoch:   0 | Iter:     14 | loss: 0.8361 average_loss: 0.7248 | lr: 1.0000e-04 | time: 8.1107 seconds | total_time_passed: 1.9252 minutes
| Epoch:   0 | Iter:     15 | loss: 0.7936 average_loss: 0.7335 | lr: 1.2000e-04 | time: 8.0995 seconds | total_time_passed: 2.0590 minutes
| Epoch:   0 | Iter:     16 | loss: 0.5045 average_loss: 0.7054 | lr: 1.4000e-04 | time: 8.0908 seconds | total_time_passed: 2.1930 minutes
| Epoch:   0 | Iter:     17 | loss: 0.5203 average_loss: 0.6832 | lr: 1.6000e-04 | time: 8.0825 seconds | total_time_passed: 2.3268 minutes
| Epoch:   0 | Iter:     18 | loss: 0.6588 average_loss: 0.6803 | lr: 1.8000e-04 | time: 8.0753 seconds | total_time_passed: 2.4607 minutes
| Epoch:   0 | Iter:     19 | loss: 0.6076 average_loss: 0.6719 | lr: 2.0000e-04 | time: 8.0690 seconds | total_time_passed: 2.5945 minutes
| Epoch:   0 | Iter:     20 | loss: 0.5811 average_loss: 0.6616 | lr: 2.2000e-04 | time: 8.0636 seconds | total_time_passed: 2.7283 minutes
| Epoch:   0 | Iter:     21 | loss: 0.5595 average_loss: 0.6501 | lr: 2.4000e-04 | time: 8.0588 seconds | total_time_passed: 2.8621 minutes
| Epoch:   0 | Iter:     22 | loss: 0.7971 average_loss: 0.6664 | lr: 2.6000e-04 | time: 8.0544 seconds | total_time_passed: 2.9959 minutes
| Epoch:   0 | Iter:     23 | loss: 0.5203 average_loss: 0.6504 | lr: 2.8000e-04 | time: 8.0502 seconds | total_time_passed: 3.1297 minutes
| Epoch:   0 | Iter:     24 | loss: 0.6791 average_loss: 0.6535 | lr: 3.0000e-04 | time: 8.0474 seconds | total_time_passed: 3.2636 minutes
| Epoch:   0 | Iter:     25 | loss: 0.6775 average_loss: 0.6561 | lr: 3.2000e-04 | time: 8.0442 seconds | total_time_passed: 3.3974 minutes
| Epoch:   0 | Iter:     26 | loss: 0.6314 average_loss: 0.6534 | lr: 3.4000e-04 | time: 8.0416 seconds | total_time_passed: 3.5312 minutes
| Epoch:   0 | Iter:     27 | loss: 0.7830 average_loss: 0.6672 | lr: 3.6000e-04 | time: 8.0392 seconds | total_time_passed: 3.6649 minutes
| Epoch:   0 | Iter:     28 | loss: 0.5847 average_loss: 0.6585 | lr: 3.8000e-04 | time: 8.0381 seconds | total_time_passed: 3.7988 minutes
| Epoch:   0 | Iter:     29 | loss: 0.6066 average_loss: 0.6530 | lr: 4.0000e-04 | time: 8.0359 seconds | total_time_passed: 3.9327 minutes
| Epoch:   0 | Iter:     30 | loss: 0.5493 average_loss: 0.6422 | lr: 4.2000e-04 | time: 8.0342 seconds | total_time_passed: 4.0665 minutes
| Epoch:   0 | Iter:     31 | loss: 0.5592 average_loss: 0.6336 | lr: 4.4000e-04 | time: 8.0325 seconds | total_time_passed: 4.2003 minutes
| Epoch:   0 | Iter:     32 | loss: 0.3730 average_loss: 0.6066 | lr: 4.6000e-04 | time: 8.0304 seconds | total_time_passed: 4.3339 minutes
| Epoch:   0 | Iter:     33 | loss: 0.5580 average_loss: 0.6016 | lr: 4.8000e-04 | time: 8.0293 seconds | total_time_passed: 4.4677 minutes
| Epoch:   0 | Iter:     34 | loss: 0.4416 average_loss: 0.5851 | lr: 5.0000e-04 | time: 8.0289 seconds | total_time_passed: 4.6016 minutes
| Epoch:   0 | Iter:     35 | loss: 0.6085 average_loss: 0.5875 | lr: 5.2000e-04 | time: 8.0279 seconds | total_time_passed: 4.7354 minutes
| Epoch:   0 | Iter:     36 | loss: 0.5408 average_loss: 0.5827 | lr: 5.4000e-04 | time: 8.0271 seconds | total_time_passed: 4.8692 minutes
| Epoch:   0 | Iter:     37 | loss: 0.8056 average_loss: 0.6055 | lr: 5.6000e-04 | time: 8.0260 seconds | total_time_passed: 5.0030 minutes
| Epoch:   0 | Iter:     38 | loss: 0.5041 average_loss: 0.5952 | lr: 5.8000e-04 | time: 8.0247 seconds | total_time_passed: 5.1367 minutes
| Epoch:   0 | Iter:     39 | loss: 0.5405 average_loss: 0.5896 | lr: 6.0000e-04 | time: 8.0246 seconds | total_time_passed: 5.2705 minutes
| Epoch:   0 | Iter:     40 | loss: 0.6324 average_loss: 0.5940 | lr: 6.2000e-04 | time: 8.0235 seconds | total_time_passed: 5.4042 minutes
| Epoch:   0 | Iter:     41 | loss: 0.4496 average_loss: 0.5793 | lr: 6.4000e-04 | time: 8.0232 seconds | total_time_passed: 5.5380 minutes
| Epoch:   0 | Iter:     42 | loss: 0.4999 average_loss: 0.5713 | lr: 6.6000e-04 | time: 8.0232 seconds | total_time_passed: 5.6719 minutes
| Epoch:   0 | Iter:     43 | loss: 0.4540 average_loss: 0.5594 | lr: 6.8000e-04 | time: 8.0234 seconds | total_time_passed: 5.8058 minutes
| Epoch:   0 | Iter:     44 | loss: 0.5280 average_loss: 0.5562 | lr: 7.0000e-04 | time: 8.0228 seconds | total_time_passed: 5.9395 minutes
| Epoch:   0 | Iter:     45 | loss: 0.4342 average_loss: 0.5439 | lr: 7.2000e-04 | time: 8.0223 seconds | total_time_passed: 6.0733 minutes
| Epoch:   0 | Iter:     46 | loss: 0.6234 average_loss: 0.5519 | lr: 7.4000e-04 | time: 8.0224 seconds | total_time_passed: 6.2071 minutes
| Epoch:   0 | Iter:     47 | loss: 0.4861 average_loss: 0.5453 | lr: 7.6000e-04 | time: 8.0227 seconds | total_time_passed: 6.3410 minutes
| Epoch:   0 | Iter:     48 | loss: 0.5490 average_loss: 0.5457 | lr: 7.8000e-04 | time: 8.0224 seconds | total_time_passed: 6.4748 minutes
| Epoch:   0 | Iter:     49 | loss: 0.6607 average_loss: 0.5573 | lr: 8.0000e-04 | time: 8.0227 seconds | total_time_passed: 6.6087 minutes
| Epoch:   0 | Iter:     50 | loss: 0.6041 average_loss: 0.5620 | lr: 8.2000e-04 | time: 8.0214 seconds | total_time_passed: 6.7423 minutes
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_0/optim.rank-1.opt
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_0/optim.rank-0.opt
model saved at ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_0
| Epoch:   1 | Iter:     51 | loss: 0.7903 average_loss: 0.5849 | lr: 8.4000e-04 | time: 8.0562 seconds | total_time_passed: 8.0982 minutes
| Epoch:   1 | Iter:     52 | loss: 0.5964 average_loss: 0.5861 | lr: 8.6000e-04 | time: 8.0530 seconds | total_time_passed: 8.2321 minutes
| Epoch:   1 | Iter:     53 | loss: 0.5090 average_loss: 0.5783 | lr: 8.8000e-04 | time: 8.0501 seconds | total_time_passed: 8.3659 minutes
| Epoch:   1 | Iter:     54 | loss: 0.5785 average_loss: 0.5783 | lr: 9.0000e-04 | time: 8.0476 seconds | total_time_passed: 8.4998 minutes
| Epoch:   1 | Iter:     55 | loss: 0.4444 average_loss: 0.5649 | lr: 9.2000e-04 | time: 8.0450 seconds | total_time_passed: 8.6337 minutes
| Epoch:   1 | Iter:     56 | loss: 0.4318 average_loss: 0.5516 | lr: 9.4000e-04 | time: 8.0424 seconds | total_time_passed: 8.7674 minutes
| Epoch:   1 | Iter:     57 | loss: 0.5579 average_loss: 0.5522 | lr: 9.6000e-04 | time: 8.0398 seconds | total_time_passed: 8.9012 minutes
| Epoch:   1 | Iter:     58 | loss: 0.6922 average_loss: 0.5662 | lr: 9.8000e-04 | time: 8.0378 seconds | total_time_passed: 9.0350 minutes
| Epoch:   1 | Iter:     59 | loss: 0.5530 average_loss: 0.5649 | lr: 1.0000e-03 | time: 8.0358 seconds | total_time_passed: 9.1688 minutes
| Epoch:   1 | Iter:     60 | loss: 0.4390 average_loss: 0.5523 | lr: 9.9994e-04 | time: 8.0329 seconds | total_time_passed: 9.3024 minutes
| Epoch:   1 | Iter:     61 | loss: 0.5568 average_loss: 0.5527 | lr: 9.9976e-04 | time: 8.0321 seconds | total_time_passed: 9.4362 minutes
| Epoch:   1 | Iter:     62 | loss: 0.5161 average_loss: 0.5491 | lr: 9.9945e-04 | time: 8.0301 seconds | total_time_passed: 9.5699 minutes
| Epoch:   1 | Iter:     63 | loss: 0.5689 average_loss: 0.5511 | lr: 9.9902e-04 | time: 8.0289 seconds | total_time_passed: 9.7037 minutes
| Epoch:   1 | Iter:     64 | loss: 0.5632 average_loss: 0.5523 | lr: 9.9847e-04 | time: 8.0283 seconds | total_time_passed: 9.8376 minutes
| Epoch:   1 | Iter:     65 | loss: 0.5134 average_loss: 0.5484 | lr: 9.9780e-04 | time: 8.0274 seconds | total_time_passed: 9.9714 minutes
| Epoch:   1 | Iter:     66 | loss: 0.5295 average_loss: 0.5465 | lr: 9.9701e-04 | time: 8.0273 seconds | total_time_passed: 10.1053 minutes
| Epoch:   1 | Iter:     67 | loss: 0.5031 average_loss: 0.5422 | lr: 9.9610e-04 | time: 8.0261 seconds | total_time_passed: 10.2391 minutes
| Epoch:   1 | Iter:     68 | loss: 0.4693 average_loss: 0.5349 | lr: 9.9506e-04 | time: 8.0271 seconds | total_time_passed: 10.3731 minutes
| Epoch:   1 | Iter:     69 | loss: 0.5042 average_loss: 0.5318 | lr: 9.9391e-04 | time: 8.0256 seconds | total_time_passed: 10.5067 minutes
| Epoch:   1 | Iter:     70 | loss: 0.5042 average_loss: 0.5290 | lr: 9.9263e-04 | time: 8.0266 seconds | total_time_passed: 10.6408 minutes
| Epoch:   1 | Iter:     71 | loss: 0.5357 average_loss: 0.5297 | lr: 9.9123e-04 | time: 8.0265 seconds | total_time_passed: 10.7746 minutes
| Epoch:   1 | Iter:     72 | loss: 0.5480 average_loss: 0.5315 | lr: 9.8971e-04 | time: 8.0252 seconds | total_time_passed: 10.9083 minutes
| Epoch:   1 | Iter:     73 | loss: 0.4012 average_loss: 0.5185 | lr: 9.8808e-04 | time: 8.0250 seconds | total_time_passed: 11.0422 minutes
| Epoch:   1 | Iter:     74 | loss: 0.4795 average_loss: 0.5146 | lr: 9.8632e-04 | time: 8.0245 seconds | total_time_passed: 11.1760 minutes
| Epoch:   1 | Iter:     75 | loss: 0.4446 average_loss: 0.5076 | lr: 9.8445e-04 | time: 8.0237 seconds | total_time_passed: 11.3097 minutes
| Epoch:   1 | Iter:     76 | loss: 0.4726 average_loss: 0.5041 | lr: 9.8245e-04 | time: 8.0230 seconds | total_time_passed: 11.4434 minutes
| Epoch:   1 | Iter:     77 | loss: 0.6433 average_loss: 0.5180 | lr: 9.8034e-04 | time: 8.0226 seconds | total_time_passed: 11.5772 minutes
| Epoch:   1 | Iter:     78 | loss: 0.5781 average_loss: 0.5240 | lr: 9.7811e-04 | time: 8.0214 seconds | total_time_passed: 11.7109 minutes
| Epoch:   1 | Iter:     79 | loss: 0.5865 average_loss: 0.5303 | lr: 9.7577e-04 | time: 8.0199 seconds | total_time_passed: 11.8444 minutes
| Epoch:   1 | Iter:     80 | loss: 0.5777 average_loss: 0.5350 | lr: 9.7331e-04 | time: 8.0200 seconds | total_time_passed: 11.9782 minutes
| Epoch:   1 | Iter:     81 | loss: 0.6395 average_loss: 0.5455 | lr: 9.7073e-04 | time: 8.0200 seconds | total_time_passed: 12.1120 minutes
| Epoch:   1 | Iter:     82 | loss: 0.4938 average_loss: 0.5403 | lr: 9.6804e-04 | time: 8.0194 seconds | total_time_passed: 12.2457 minutes
| Epoch:   1 | Iter:     83 | loss: 0.4079 average_loss: 0.5271 | lr: 9.6523e-04 | time: 8.0194 seconds | total_time_passed: 12.3795 minutes
| Epoch:   1 | Iter:     84 | loss: 0.4373 average_loss: 0.5181 | lr: 9.6231e-04 | time: 8.0198 seconds | total_time_passed: 12.5134 minutes
| Epoch:   1 | Iter:     85 | loss: 0.5724 average_loss: 0.5235 | lr: 9.5928e-04 | time: 8.0205 seconds | total_time_passed: 12.6473 minutes
| Epoch:   1 | Iter:     86 | loss: 0.4827 average_loss: 0.5194 | lr: 9.5613e-04 | time: 8.0196 seconds | total_time_passed: 12.7809 minutes
| Epoch:   1 | Iter:     87 | loss: 0.4800 average_loss: 0.5155 | lr: 9.5288e-04 | time: 8.0188 seconds | total_time_passed: 12.9145 minutes
| Epoch:   1 | Iter:     88 | loss: 0.5137 average_loss: 0.5153 | lr: 9.4951e-04 | time: 8.0192 seconds | total_time_passed: 13.0483 minutes
| Epoch:   1 | Iter:     89 | loss: 0.5907 average_loss: 0.5228 | lr: 9.4603e-04 | time: 8.0190 seconds | total_time_passed: 13.1821 minutes
| Epoch:   1 | Iter:     90 | loss: 0.7421 average_loss: 0.5448 | lr: 9.4245e-04 | time: 8.0189 seconds | total_time_passed: 13.3158 minutes
| Epoch:   1 | Iter:     91 | loss: 0.5180 average_loss: 0.5421 | lr: 9.3875e-04 | time: 8.0191 seconds | total_time_passed: 13.4496 minutes
| Epoch:   1 | Iter:     92 | loss: 0.4247 average_loss: 0.5304 | lr: 9.3495e-04 | time: 8.0187 seconds | total_time_passed: 13.5834 minutes
| Epoch:   1 | Iter:     93 | loss: 0.5751 average_loss: 0.5348 | lr: 9.3105e-04 | time: 8.0189 seconds | total_time_passed: 13.7171 minutes
| Epoch:   1 | Iter:     94 | loss: 0.5883 average_loss: 0.5402 | lr: 9.2703e-04 | time: 8.0188 seconds | total_time_passed: 13.8509 minutes
| Epoch:   1 | Iter:     95 | loss: 0.6106 average_loss: 0.5472 | lr: 9.2292e-04 | time: 8.0194 seconds | total_time_passed: 13.9848 minutes
| Epoch:   1 | Iter:     96 | loss: 0.4452 average_loss: 0.5370 | lr: 9.1870e-04 | time: 8.0190 seconds | total_time_passed: 14.1186 minutes
| Epoch:   1 | Iter:     97 | loss: 0.5567 average_loss: 0.5390 | lr: 9.1437e-04 | time: 8.0192 seconds | total_time_passed: 14.2524 minutes
| Epoch:   1 | Iter:     98 | loss: 0.5957 average_loss: 0.5446 | lr: 9.0995e-04 | time: 8.0197 seconds | total_time_passed: 14.3863 minutes
| Epoch:   1 | Iter:     99 | loss: 0.5633 average_loss: 0.5465 | lr: 9.0543e-04 | time: 8.0194 seconds | total_time_passed: 14.5201 minutes
| Epoch:   1 | Iter:    100 | loss: 0.5290 average_loss: 0.5448 | lr: 9.0080e-04 | time: 8.0194 seconds | total_time_passed: 14.6538 minutes
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_1/optim.rank-1.opt
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_1/optim.rank-0.opt
model saved at ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_1
| Epoch:   2 | Iter:    101 | loss: 0.4306 average_loss: 0.5333 | lr: 8.9608e-04 | time: 8.0614 seconds | total_time_passed: 16.0428 minutes
| Epoch:   2 | Iter:    102 | loss: 0.5409 average_loss: 0.5341 | lr: 8.9126e-04 | time: 8.0570 seconds | total_time_passed: 16.1771 minutes
| Epoch:   2 | Iter:    103 | loss: 0.5172 average_loss: 0.5324 | lr: 8.8635e-04 | time: 8.0530 seconds | total_time_passed: 16.3108 minutes
| Epoch:   2 | Iter:    104 | loss: 0.7188 average_loss: 0.5511 | lr: 8.8134e-04 | time: 8.0498 seconds | total_time_passed: 16.4446 minutes
| Epoch:   2 | Iter:    105 | loss: 0.4228 average_loss: 0.5382 | lr: 8.7624e-04 | time: 8.0477 seconds | total_time_passed: 16.5785 minutes
| Epoch:   2 | Iter:    106 | loss: 0.5894 average_loss: 0.5433 | lr: 8.7105e-04 | time: 8.0448 seconds | total_time_passed: 16.7123 minutes
| Epoch:   2 | Iter:    107 | loss: 0.3908 average_loss: 0.5281 | lr: 8.6577e-04 | time: 8.0424 seconds | total_time_passed: 16.8462 minutes
| Epoch:   2 | Iter:    108 | loss: 0.4573 average_loss: 0.5210 | lr: 8.6039e-04 | time: 8.0397 seconds | total_time_passed: 16.9799 minutes
| Epoch:   2 | Iter:    109 | loss: 0.5051 average_loss: 0.5194 | lr: 8.5493e-04 | time: 8.0372 seconds | total_time_passed: 17.1137 minutes
| Epoch:   2 | Iter:    110 | loss: 0.4776 average_loss: 0.5152 | lr: 8.4938e-04 | time: 8.0354 seconds | total_time_passed: 17.2475 minutes
| Epoch:   2 | Iter:    111 | loss: 0.4919 average_loss: 0.5129 | lr: 8.4375e-04 | time: 8.0343 seconds | total_time_passed: 17.3814 minutes
| Epoch:   2 | Iter:    112 | loss: 0.4501 average_loss: 0.5066 | lr: 8.3804e-04 | time: 8.0330 seconds | total_time_passed: 17.5153 minutes
| Epoch:   2 | Iter:    113 | loss: 0.5340 average_loss: 0.5094 | lr: 8.3224e-04 | time: 8.0299 seconds | total_time_passed: 17.6488 minutes
| Epoch:   2 | Iter:    114 | loss: 0.5154 average_loss: 0.5100 | lr: 8.2636e-04 | time: 8.0289 seconds | total_time_passed: 17.7825 minutes
| Epoch:   2 | Iter:    115 | loss: 0.4505 average_loss: 0.5040 | lr: 8.2039e-04 | time: 8.0275 seconds | total_time_passed: 17.9162 minutes
| Epoch:   2 | Iter:    116 | loss: 0.4594 average_loss: 0.4996 | lr: 8.1436e-04 | time: 8.0264 seconds | total_time_passed: 18.0500 minutes
| Epoch:   2 | Iter:    117 | loss: 0.6002 average_loss: 0.5096 | lr: 8.0824e-04 | time: 8.0259 seconds | total_time_passed: 18.1838 minutes
| Epoch:   2 | Iter:    118 | loss: 0.5598 average_loss: 0.5146 | lr: 8.0205e-04 | time: 8.0254 seconds | total_time_passed: 18.3176 minutes
| Epoch:   2 | Iter:    119 | loss: 0.5368 average_loss: 0.5169 | lr: 7.9579e-04 | time: 8.0246 seconds | total_time_passed: 18.4513 minutes
| Epoch:   2 | Iter:    120 | loss: 0.4587 average_loss: 0.5110 | lr: 7.8945e-04 | time: 8.0234 seconds | total_time_passed: 18.5850 minutes
| Epoch:   2 | Iter:    121 | loss: 0.4855 average_loss: 0.5085 | lr: 7.8304e-04 | time: 8.0224 seconds | total_time_passed: 18.7187 minutes
| Epoch:   2 | Iter:    122 | loss: 0.4672 average_loss: 0.5044 | lr: 7.7657e-04 | time: 8.0217 seconds | total_time_passed: 18.8524 minutes
| Epoch:   2 | Iter:    123 | loss: 0.6985 average_loss: 0.5238 | lr: 7.7002e-04 | time: 8.0221 seconds | total_time_passed: 18.9863 minutes
| Epoch:   2 | Iter:    124 | loss: 0.4956 average_loss: 0.5209 | lr: 7.6341e-04 | time: 8.0220 seconds | total_time_passed: 19.1201 minutes
| Epoch:   2 | Iter:    125 | loss: 0.4220 average_loss: 0.5111 | lr: 7.5674e-04 | time: 8.0218 seconds | total_time_passed: 19.2539 minutes
| Epoch:   2 | Iter:    126 | loss: 0.6284 average_loss: 0.5228 | lr: 7.5000e-04 | time: 8.0214 seconds | total_time_passed: 19.3877 minutes
| Epoch:   2 | Iter:    127 | loss: 0.5029 average_loss: 0.5208 | lr: 7.4320e-04 | time: 8.0214 seconds | total_time_passed: 19.5215 minutes
| Epoch:   2 | Iter:    128 | loss: 0.3800 average_loss: 0.5067 | lr: 7.3634e-04 | time: 8.0216 seconds | total_time_passed: 19.6554 minutes
| Epoch:   2 | Iter:    129 | loss: 0.5188 average_loss: 0.5079 | lr: 7.2943e-04 | time: 8.0216 seconds | total_time_passed: 19.7892 minutes
| Epoch:   2 | Iter:    130 | loss: 0.4710 average_loss: 0.5042 | lr: 7.2246e-04 | time: 8.0215 seconds | total_time_passed: 19.9230 minutes
| Epoch:   2 | Iter:    131 | loss: 0.7552 average_loss: 0.5293 | lr: 7.1543e-04 | time: 8.0204 seconds | total_time_passed: 20.0566 minutes
| Epoch:   2 | Iter:    132 | loss: 0.5560 average_loss: 0.5320 | lr: 7.0835e-04 | time: 8.0204 seconds | total_time_passed: 20.1904 minutes
| Epoch:   2 | Iter:    133 | loss: 0.4430 average_loss: 0.5231 | lr: 7.0122e-04 | time: 8.0203 seconds | total_time_passed: 20.3242 minutes
| Epoch:   2 | Iter:    134 | loss: 0.3729 average_loss: 0.5081 | lr: 6.9405e-04 | time: 8.0207 seconds | total_time_passed: 20.4581 minutes
| Epoch:   2 | Iter:    135 | loss: 0.5095 average_loss: 0.5082 | lr: 6.8682e-04 | time: 8.0199 seconds | total_time_passed: 20.5918 minutes
| Epoch:   2 | Iter:    136 | loss: 0.5251 average_loss: 0.5099 | lr: 6.7955e-04 | time: 8.0194 seconds | total_time_passed: 20.7256 minutes
| Epoch:   2 | Iter:    137 | loss: 0.5777 average_loss: 0.5167 | lr: 6.7223e-04 | time: 8.0192 seconds | total_time_passed: 20.8593 minutes
| Epoch:   2 | Iter:    138 | loss: 0.4918 average_loss: 0.5142 | lr: 6.6488e-04 | time: 8.0204 seconds | total_time_passed: 20.9933 minutes
| Epoch:   2 | Iter:    139 | loss: 0.6367 average_loss: 0.5264 | lr: 6.5748e-04 | time: 8.0213 seconds | total_time_passed: 21.1272 minutes
| Epoch:   2 | Iter:    140 | loss: 0.4815 average_loss: 0.5220 | lr: 6.5004e-04 | time: 8.0201 seconds | total_time_passed: 21.2609 minutes
| Epoch:   2 | Iter:    141 | loss: 0.4950 average_loss: 0.5193 | lr: 6.4257e-04 | time: 8.0203 seconds | total_time_passed: 21.3946 minutes
| Epoch:   2 | Iter:    142 | loss: 0.6131 average_loss: 0.5286 | lr: 6.3506e-04 | time: 8.0200 seconds | total_time_passed: 21.5284 minutes
| Epoch:   2 | Iter:    143 | loss: 0.3374 average_loss: 0.5095 | lr: 6.2752e-04 | time: 8.0197 seconds | total_time_passed: 21.6621 minutes
| Epoch:   2 | Iter:    144 | loss: 0.4722 average_loss: 0.5058 | lr: 6.1995e-04 | time: 8.0183 seconds | total_time_passed: 21.7957 minutes
| Epoch:   2 | Iter:    145 | loss: 0.5447 average_loss: 0.5097 | lr: 6.1235e-04 | time: 8.0174 seconds | total_time_passed: 21.9293 minutes
| Epoch:   2 | Iter:    146 | loss: 0.4272 average_loss: 0.5014 | lr: 6.0472e-04 | time: 8.0173 seconds | total_time_passed: 22.0630 minutes
| Epoch:   2 | Iter:    147 | loss: 0.5079 average_loss: 0.5021 | lr: 5.9707e-04 | time: 8.0176 seconds | total_time_passed: 22.1968 minutes
| Epoch:   2 | Iter:    148 | loss: 0.5545 average_loss: 0.5073 | lr: 5.8939e-04 | time: 8.0170 seconds | total_time_passed: 22.3304 minutes
| Epoch:   2 | Iter:    149 | loss: 0.4592 average_loss: 0.5025 | lr: 5.8169e-04 | time: 8.0179 seconds | total_time_passed: 22.4644 minutes
| Epoch:   2 | Iter:    150 | loss: 0.5597 average_loss: 0.5082 | lr: 5.7397e-04 | time: 8.0175 seconds | total_time_passed: 22.5981 minutes
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_2/optim.rank-1.opt
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_2/optim.rank-0.opt
model saved at ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_2
| Epoch:   3 | Iter:    151 | loss: 0.4714 average_loss: 0.5045 | lr: 5.6623e-04 | time: 8.0520 seconds | total_time_passed: 23.9776 minutes
| Epoch:   3 | Iter:    152 | loss: 0.4663 average_loss: 0.5007 | lr: 5.5848e-04 | time: 8.0495 seconds | total_time_passed: 24.1120 minutes
| Epoch:   3 | Iter:    153 | loss: 0.4578 average_loss: 0.4964 | lr: 5.5071e-04 | time: 8.0468 seconds | total_time_passed: 24.2458 minutes
| Epoch:   3 | Iter:    154 | loss: 0.4450 average_loss: 0.4913 | lr: 5.4293e-04 | time: 8.0433 seconds | total_time_passed: 24.3795 minutes
| Epoch:   3 | Iter:    155 | loss: 0.4348 average_loss: 0.4856 | lr: 5.3514e-04 | time: 8.0414 seconds | total_time_passed: 24.5133 minutes
| Epoch:   3 | Iter:    156 | loss: 0.4155 average_loss: 0.4786 | lr: 5.2734e-04 | time: 8.0396 seconds | total_time_passed: 24.6472 minutes
| Epoch:   3 | Iter:    157 | loss: 0.4437 average_loss: 0.4751 | lr: 5.1953e-04 | time: 8.0372 seconds | total_time_passed: 24.7809 minutes
| Epoch:   3 | Iter:    158 | loss: 0.4842 average_loss: 0.4760 | lr: 5.1172e-04 | time: 8.0350 seconds | total_time_passed: 24.9147 minutes
| Epoch:   3 | Iter:    159 | loss: 0.4589 average_loss: 0.4743 | lr: 5.0391e-04 | time: 8.0336 seconds | total_time_passed: 25.0485 minutes
| Epoch:   3 | Iter:    160 | loss: 0.5057 average_loss: 0.4775 | lr: 4.9609e-04 | time: 8.0318 seconds | total_time_passed: 25.1823 minutes
| Epoch:   3 | Iter:    161 | loss: 0.3804 average_loss: 0.4677 | lr: 4.8828e-04 | time: 8.0308 seconds | total_time_passed: 25.3161 minutes
| Epoch:   3 | Iter:    162 | loss: 0.5077 average_loss: 0.4717 | lr: 4.8047e-04 | time: 8.0295 seconds | total_time_passed: 25.4499 minutes
| Epoch:   3 | Iter:    163 | loss: 0.3589 average_loss: 0.4605 | lr: 4.7266e-04 | time: 8.0289 seconds | total_time_passed: 25.5837 minutes
| Epoch:   3 | Iter:    164 | loss: 0.5339 average_loss: 0.4678 | lr: 4.6486e-04 | time: 8.0282 seconds | total_time_passed: 25.7176 minutes
| Epoch:   3 | Iter:    165 | loss: 0.6299 average_loss: 0.4840 | lr: 4.5707e-04 | time: 8.0272 seconds | total_time_passed: 25.8514 minutes
| Epoch:   3 | Iter:    166 | loss: 0.4821 average_loss: 0.4838 | lr: 4.4929e-04 | time: 8.0258 seconds | total_time_passed: 25.9851 minutes
| Epoch:   3 | Iter:    167 | loss: 0.6386 average_loss: 0.4993 | lr: 4.4152e-04 | time: 8.0247 seconds | total_time_passed: 26.1189 minutes
| Epoch:   3 | Iter:    168 | loss: 0.7979 average_loss: 0.5291 | lr: 4.3377e-04 | time: 8.0249 seconds | total_time_passed: 26.2527 minutes
| Epoch:   3 | Iter:    169 | loss: 0.4864 average_loss: 0.5249 | lr: 4.2603e-04 | time: 8.0239 seconds | total_time_passed: 26.3865 minutes
| Epoch:   3 | Iter:    170 | loss: 0.5094 average_loss: 0.5233 | lr: 4.1831e-04 | time: 8.0237 seconds | total_time_passed: 26.5203 minutes
| Epoch:   3 | Iter:    171 | loss: 0.5602 average_loss: 0.5270 | lr: 4.1061e-04 | time: 8.0229 seconds | total_time_passed: 26.6540 minutes
| Epoch:   3 | Iter:    172 | loss: 0.3735 average_loss: 0.5117 | lr: 4.0293e-04 | time: 8.0219 seconds | total_time_passed: 26.7876 minutes
| Epoch:   3 | Iter:    173 | loss: 0.5141 average_loss: 0.5119 | lr: 3.9528e-04 | time: 8.0216 seconds | total_time_passed: 26.9214 minutes
| Epoch:   3 | Iter:    174 | loss: 0.4040 average_loss: 0.5011 | lr: 3.8765e-04 | time: 8.0212 seconds | total_time_passed: 27.0552 minutes
| Epoch:   3 | Iter:    175 | loss: 0.5260 average_loss: 0.5036 | lr: 3.8005e-04 | time: 8.0208 seconds | total_time_passed: 27.1889 minutes
| Epoch:   3 | Iter:    176 | loss: 0.4287 average_loss: 0.4961 | lr: 3.7248e-04 | time: 8.0207 seconds | total_time_passed: 27.3227 minutes
| Epoch:   3 | Iter:    177 | loss: 0.4971 average_loss: 0.4962 | lr: 3.6494e-04 | time: 8.0203 seconds | total_time_passed: 27.4565 minutes
| Epoch:   3 | Iter:    178 | loss: 0.5646 average_loss: 0.5030 | lr: 3.5743e-04 | time: 8.0207 seconds | total_time_passed: 27.5903 minutes
| Epoch:   3 | Iter:    179 | loss: 0.5203 average_loss: 0.5048 | lr: 3.4996e-04 | time: 8.0207 seconds | total_time_passed: 27.7242 minutes
| Epoch:   3 | Iter:    180 | loss: 0.4361 average_loss: 0.4979 | lr: 3.4252e-04 | time: 8.0208 seconds | total_time_passed: 27.8581 minutes
| Epoch:   3 | Iter:    181 | loss: 0.5129 average_loss: 0.4994 | lr: 3.3512e-04 | time: 8.0211 seconds | total_time_passed: 27.9919 minutes
| Epoch:   3 | Iter:    182 | loss: 0.5979 average_loss: 0.5092 | lr: 3.2777e-04 | time: 8.0205 seconds | total_time_passed: 28.1257 minutes
| Epoch:   3 | Iter:    183 | loss: 0.4500 average_loss: 0.5033 | lr: 3.2045e-04 | time: 8.0208 seconds | total_time_passed: 28.2595 minutes
| Epoch:   3 | Iter:    184 | loss: 0.5513 average_loss: 0.5081 | lr: 3.1318e-04 | time: 8.0196 seconds | total_time_passed: 28.3931 minutes
| Epoch:   3 | Iter:    185 | loss: 0.5325 average_loss: 0.5106 | lr: 3.0595e-04 | time: 8.0194 seconds | total_time_passed: 28.5268 minutes
| Epoch:   3 | Iter:    186 | loss: 0.4811 average_loss: 0.5076 | lr: 2.9878e-04 | time: 8.0188 seconds | total_time_passed: 28.6605 minutes
| Epoch:   3 | Iter:    187 | loss: 0.5088 average_loss: 0.5077 | lr: 2.9165e-04 | time: 8.0189 seconds | total_time_passed: 28.7943 minutes
| Epoch:   3 | Iter:    188 | loss: 0.5147 average_loss: 0.5084 | lr: 2.8457e-04 | time: 8.0193 seconds | total_time_passed: 28.9281 minutes
| Epoch:   3 | Iter:    189 | loss: 0.5413 average_loss: 0.5117 | lr: 2.7754e-04 | time: 8.0192 seconds | total_time_passed: 29.0619 minutes
| Epoch:   3 | Iter:    190 | loss: 0.5204 average_loss: 0.5126 | lr: 2.7057e-04 | time: 8.0189 seconds | total_time_passed: 29.1957 minutes
| Epoch:   3 | Iter:    191 | loss: 0.4455 average_loss: 0.5059 | lr: 2.6366e-04 | time: 8.0188 seconds | total_time_passed: 29.3294 minutes
| Epoch:   3 | Iter:    192 | loss: 0.4359 average_loss: 0.4989 | lr: 2.5680e-04 | time: 8.0191 seconds | total_time_passed: 29.4633 minutes
| Epoch:   3 | Iter:    193 | loss: 0.5564 average_loss: 0.5046 | lr: 2.5000e-04 | time: 8.0192 seconds | total_time_passed: 29.5971 minutes
| Epoch:   3 | Iter:    194 | loss: 0.4359 average_loss: 0.4978 | lr: 2.4326e-04 | time: 8.0194 seconds | total_time_passed: 29.7310 minutes
| Epoch:   3 | Iter:    195 | loss: 0.5125 average_loss: 0.4992 | lr: 2.3659e-04 | time: 8.0194 seconds | total_time_passed: 29.8648 minutes
| Epoch:   3 | Iter:    196 | loss: 0.4292 average_loss: 0.4922 | lr: 2.2998e-04 | time: 8.0195 seconds | total_time_passed: 29.9986 minutes
| Epoch:   3 | Iter:    197 | loss: 0.4743 average_loss: 0.4904 | lr: 2.2343e-04 | time: 8.0194 seconds | total_time_passed: 30.1323 minutes
| Epoch:   3 | Iter:    198 | loss: 0.6205 average_loss: 0.5034 | lr: 2.1696e-04 | time: 8.0197 seconds | total_time_passed: 30.2662 minutes
| Epoch:   3 | Iter:    199 | loss: 0.5559 average_loss: 0.5087 | lr: 2.1055e-04 | time: 8.0192 seconds | total_time_passed: 30.3998 minutes
| Epoch:   3 | Iter:    200 | loss: 0.4980 average_loss: 0.5076 | lr: 2.0421e-04 | time: 8.0187 seconds | total_time_passed: 30.5336 minutes
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_3/optim.rank-1.opt
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_3/optim.rank-0.opt
model saved at ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_3
| Epoch:   4 | Iter:    201 | loss: 0.4972 average_loss: 0.5066 | lr: 1.9795e-04 | time: 8.0607 seconds | total_time_passed: 31.8113 minutes
| Epoch:   4 | Iter:    202 | loss: 0.4299 average_loss: 0.4989 | lr: 1.9176e-04 | time: 8.0565 seconds | total_time_passed: 31.9454 minutes
| Epoch:   4 | Iter:    203 | loss: 0.4853 average_loss: 0.4975 | lr: 1.8564e-04 | time: 8.0523 seconds | total_time_passed: 32.0791 minutes
| Epoch:   4 | Iter:    204 | loss: 0.4131 average_loss: 0.4891 | lr: 1.7961e-04 | time: 8.0501 seconds | total_time_passed: 32.2131 minutes
| Epoch:   4 | Iter:    205 | loss: 0.6393 average_loss: 0.5041 | lr: 1.7364e-04 | time: 8.0474 seconds | total_time_passed: 32.3469 minutes
| Epoch:   4 | Iter:    206 | loss: 0.5386 average_loss: 0.5076 | lr: 1.6776e-04 | time: 8.0456 seconds | total_time_passed: 32.4809 minutes
| Epoch:   4 | Iter:    207 | loss: 0.5564 average_loss: 0.5124 | lr: 1.6196e-04 | time: 8.0430 seconds | total_time_passed: 32.6146 minutes
| Epoch:   4 | Iter:    208 | loss: 0.5320 average_loss: 0.5144 | lr: 1.5625e-04 | time: 8.0411 seconds | total_time_passed: 32.7485 minutes
| Epoch:   4 | Iter:    209 | loss: 0.4309 average_loss: 0.5060 | lr: 1.5062e-04 | time: 8.0386 seconds | total_time_passed: 32.8822 minutes
| Epoch:   4 | Iter:    210 | loss: 0.4653 average_loss: 0.5020 | lr: 1.4507e-04 | time: 8.0363 seconds | total_time_passed: 33.0159 minutes
| Epoch:   4 | Iter:    211 | loss: 0.5893 average_loss: 0.5107 | lr: 1.3961e-04 | time: 8.0345 seconds | total_time_passed: 33.1497 minutes
| Epoch:   4 | Iter:    212 | loss: 0.5373 average_loss: 0.5134 | lr: 1.3423e-04 | time: 8.0326 seconds | total_time_passed: 33.2834 minutes
| Epoch:   4 | Iter:    213 | loss: 0.3730 average_loss: 0.4993 | lr: 1.2895e-04 | time: 8.0310 seconds | total_time_passed: 33.4172 minutes
| Epoch:   4 | Iter:    214 | loss: 0.6201 average_loss: 0.5114 | lr: 1.2376e-04 | time: 8.0294 seconds | total_time_passed: 33.5509 minutes
| Epoch:   4 | Iter:    215 | loss: 0.5749 average_loss: 0.5177 | lr: 1.1866e-04 | time: 8.0289 seconds | total_time_passed: 33.6847 minutes
| Epoch:   4 | Iter:    216 | loss: 0.4722 average_loss: 0.5132 | lr: 1.1365e-04 | time: 8.0289 seconds | total_time_passed: 33.8187 minutes
| Epoch:   4 | Iter:    217 | loss: 0.6056 average_loss: 0.5224 | lr: 1.0874e-04 | time: 8.0282 seconds | total_time_passed: 33.9525 minutes
| Epoch:   4 | Iter:    218 | loss: 0.4780 average_loss: 0.5180 | lr: 1.0392e-04 | time: 8.0283 seconds | total_time_passed: 34.0865 minutes
| Epoch:   4 | Iter:    219 | loss: 0.4761 average_loss: 0.5138 | lr: 9.9198e-05 | time: 8.0273 seconds | total_time_passed: 34.2203 minutes
| Epoch:   4 | Iter:    220 | loss: 0.5644 average_loss: 0.5189 | lr: 9.4575e-05 | time: 8.0263 seconds | total_time_passed: 34.3540 minutes
| Epoch:   4 | Iter:    221 | loss: 0.4506 average_loss: 0.5120 | lr: 9.0051e-05 | time: 8.0256 seconds | total_time_passed: 34.4878 minutes
| Epoch:   4 | Iter:    222 | loss: 0.4958 average_loss: 0.5104 | lr: 8.5627e-05 | time: 8.0243 seconds | total_time_passed: 34.6214 minutes
| Epoch:   4 | Iter:    223 | loss: 0.4315 average_loss: 0.5025 | lr: 8.1304e-05 | time: 8.0237 seconds | total_time_passed: 34.7552 minutes
| Epoch:   4 | Iter:    224 | loss: 0.4557 average_loss: 0.4978 | lr: 7.7084e-05 | time: 8.0240 seconds | total_time_passed: 34.8891 minutes
| Epoch:   4 | Iter:    225 | loss: 0.5744 average_loss: 0.5055 | lr: 7.2967e-05 | time: 8.0243 seconds | total_time_passed: 35.0230 minutes
| Epoch:   4 | Iter:    226 | loss: 0.4454 average_loss: 0.4995 | lr: 6.8954e-05 | time: 8.0247 seconds | total_time_passed: 35.1570 minutes
| Epoch:   4 | Iter:    227 | loss: 0.3920 average_loss: 0.4887 | lr: 6.5047e-05 | time: 8.0246 seconds | total_time_passed: 35.2909 minutes
| Epoch:   4 | Iter:    228 | loss: 0.4014 average_loss: 0.4800 | lr: 6.1246e-05 | time: 8.0238 seconds | total_time_passed: 35.4246 minutes
| Epoch:   4 | Iter:    229 | loss: 0.5091 average_loss: 0.4829 | lr: 5.7552e-05 | time: 8.0234 seconds | total_time_passed: 35.5583 minutes
| Epoch:   4 | Iter:    230 | loss: 0.4754 average_loss: 0.4822 | lr: 5.3966e-05 | time: 8.0227 seconds | total_time_passed: 35.6921 minutes
| Epoch:   4 | Iter:    231 | loss: 0.5438 average_loss: 0.4883 | lr: 5.0489e-05 | time: 8.0221 seconds | total_time_passed: 35.8259 minutes
| Epoch:   4 | Iter:    232 | loss: 0.4550 average_loss: 0.4850 | lr: 4.7122e-05 | time: 8.0222 seconds | total_time_passed: 35.9597 minutes
| Epoch:   4 | Iter:    233 | loss: 0.4699 average_loss: 0.4835 | lr: 4.3865e-05 | time: 8.0242 seconds | total_time_passed: 36.0939 minutes
| Epoch:   4 | Iter:    234 | loss: 0.4934 average_loss: 0.4845 | lr: 4.0720e-05 | time: 8.0241 seconds | total_time_passed: 36.2277 minutes
| Epoch:   4 | Iter:    235 | loss: 0.5354 average_loss: 0.4896 | lr: 3.7687e-05 | time: 8.0233 seconds | total_time_passed: 36.3615 minutes
| Epoch:   4 | Iter:    236 | loss: 0.5446 average_loss: 0.4951 | lr: 3.4767e-05 | time: 8.0228 seconds | total_time_passed: 36.4953 minutes
| Epoch:   4 | Iter:    237 | loss: 0.4022 average_loss: 0.4858 | lr: 3.1961e-05 | time: 8.0227 seconds | total_time_passed: 36.6292 minutes
| Epoch:   4 | Iter:    238 | loss: 0.5376 average_loss: 0.4910 | lr: 2.9269e-05 | time: 8.0231 seconds | total_time_passed: 36.7632 minutes
| Epoch:   4 | Iter:    239 | loss: 0.4067 average_loss: 0.4825 | lr: 2.6692e-05 | time: 8.0236 seconds | total_time_passed: 36.8971 minutes
| Epoch:   4 | Iter:    240 | loss: 0.4528 average_loss: 0.4796 | lr: 2.4231e-05 | time: 8.0232 seconds | total_time_passed: 37.0309 minutes
| Epoch:   4 | Iter:    241 | loss: 0.3694 average_loss: 0.4686 | lr: 2.1886e-05 | time: 8.0229 seconds | total_time_passed: 37.1648 minutes
| Epoch:   4 | Iter:    242 | loss: 0.5888 average_loss: 0.4806 | lr: 1.9657e-05 | time: 8.0222 seconds | total_time_passed: 37.2984 minutes
| Epoch:   4 | Iter:    243 | loss: 0.5312 average_loss: 0.4856 | lr: 1.7546e-05 | time: 8.0221 seconds | total_time_passed: 37.4323 minutes
| Epoch:   4 | Iter:    244 | loss: 0.5775 average_loss: 0.4948 | lr: 1.5553e-05 | time: 8.0215 seconds | total_time_passed: 37.5660 minutes
| Epoch:   4 | Iter:    245 | loss: 0.5247 average_loss: 0.4978 | lr: 1.3679e-05 | time: 8.0214 seconds | total_time_passed: 37.6998 minutes
| Epoch:   4 | Iter:    246 | loss: 0.4164 average_loss: 0.4897 | lr: 1.1923e-05 | time: 8.0217 seconds | total_time_passed: 37.8337 minutes
| Epoch:   4 | Iter:    247 | loss: 0.4126 average_loss: 0.4820 | lr: 1.0286e-05 | time: 8.0219 seconds | total_time_passed: 37.9676 minutes
| Epoch:   4 | Iter:    248 | loss: 0.4754 average_loss: 0.4813 | lr: 8.7687e-06 | time: 8.0221 seconds | total_time_passed: 38.1015 minutes
| Epoch:   4 | Iter:    249 | loss: 0.4260 average_loss: 0.4758 | lr: 7.3716e-06 | time: 8.0222 seconds | total_time_passed: 38.2354 minutes
| Epoch:   4 | Iter:    250 | loss: 0.3938 average_loss: 0.4676 | lr: 6.0949e-06 | time: 8.0223 seconds | total_time_passed: 38.3692 minutes
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_4/optim.rank-1.opt
saving optimizer state ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_4/optim.rank-0.opt
model saved at ./../mAlign/bsz_2_lr_1e-3_epoch_5_7b/checkpoints/epoch_4
